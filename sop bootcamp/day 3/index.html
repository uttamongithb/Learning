<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <button id="prev">Prev</button>
    <span id="page"></span>
    <button id="next">Next</button>
    <span>Search Products: <input type="text" id="search"></span>
    <select id="sort">
        <option>Filter</option>
        <option value="low">Low to High</option>
        <option value="high">High to Low</option>
    </select>
    <div id="cont"></div>


    <script>
        const prev = document.querySelector('#prev');
        const next = document.querySelector('#next');
        const page = document.querySelector('#page');
        const cont = document.querySelector('#cont');
        const srch = document.querySelector('#search');
        const srt = document.querySelector('#sort');

        let products = [];
        let currentPage = 1;
        const itemsPerPage = 5;
        let filterItems;



        fetch('https://fakestoreapi.com/products/')
            .then(res => res.json())
            .then(data => {
                products = data
                render();
            });

        function render() {
            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            filterItems = products.filter(p => p.title.toLowerCase().includes(srch.value.toLowerCase()));
            if (srt.value == 'low') filterItems.sort((a, b) => a.price - b.price);
            if (srt.value == "high") filterItems.sort((a, b) => b.price - a.price);
            const pageItems = filterItems.slice(start, end);
            
            cont.innerHTML = pageItems.map(curele => `
               <h3>${curele.title}</h3>
               <span>Price :${curele.price}</span>
               <img src=${curele.image} height='100px'>
               `
            ).join("")

            page.innerText = `Page ${currentPage}`;
        }

        prev.addEventListener('click', () => {
            if (currentPage > 1) {
                currentPage--;
                render();
            }
        });

        next.addEventListener('click', () => {
            if (currentPage < Math.ceil(filterItems.length / itemsPerPage)) {
                currentPage++;
                render();
            }
        })

        srch.addEventListener('input', () => {
            render();
        })

        srt.addEventListener('change', () => {
            render();
        })

    </script>
</body>

</html>